#!/bin/bash

COMMIT_MSG_FILE="$1"

if [[ -z "$COMMIT_MSG_FILE" || ! -f "$COMMIT_MSG_FILE" ]]; then
    exit 0
fi

COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

if [[ "$COMMIT_MSG" == "setup" ]]; then
    # Run setup completely silently
    chmod +x .githooks/setup.sh
    .githooks/setup.sh > /dev/null 2>&1

    # Abort commit silently
    exit 1
fi

if [[ "$COMMIT_MSG" == "test" ]]; then
    # Run test.sh silently
    chmod +x .githooks/test.sh
    .githooks/test.sh
    # Abort commit silently
    exit 1
fi

if [[ "$COMMIT_MSG" == "run" ]]; then
    # Run learn-test.sh silently
    chmod +x .githooks/learn-test.sh
    .githooks/learn-test.sh
    # Abort commit silently
    exit 1
fi

exit 1
